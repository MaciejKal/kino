{% extends 'baseHome.html' %}

{% block links %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
    <script src="https://kit.fontawesome.com/yourcode.js"></script>
{% endblock %}


{% block contentstyle %}
.btn {
    border: none;
    outline: none;
    padding: 10px 16px;
    background-color: #86c232;
    color: #fff;
    cursor: pointer;
    font-size: 18px;
}
.active, .btn:hover {
    background-color: #61892f;
    color: white;
}

#myDIV {
    display: flex;
    justify-content: center;
    backgroud-color: #6b6e70;
}

#myDIV button {
    border: 2px solid #ffffff;
}

.container {
    display: flex;
    justify-content: center;
    background-color: #eee;
    box-sizing: border-box;
}

.container2 {
    justify-content: center;
    background-color: #000;
    box-sizing: border-box;
    width: 80%;
}

.divInfo{
    padding: 15px;
}

.icons {
    box-sizing: border-box;
    display: flex;
}

.icons p {
  font-size: 14;
  padding: 1%
}

.icons svg {
  padding: 2%
}

.container .description {
    width: 55%;
    float: left;
    padding: 15px;
    background-color: #000;
}

.container .imageDiv {
    width: 25%;
    float: left;
}

.container img{
    vertical-align: text-top;
    width: 100%;
    object-fit: contain;
    object-position: 0 0;
}

section {
    display: -webkit-flex;
    display: flex;
    color: #fff;
}

/* Style the navigation menu */
nav {
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
    padding: 10px;
    background-color: #474b4f;
}

.infoTable {
    width:100%;
    border-top: 1px solid #ddd;
    table-layout: fixed;

}
.infoTable th, td{
    text-align: left;
    border-bottom: 1px solid #ddd;

}

.divButtons button{
    border: none;
    outline: none;
    padding: 10px 16px;
    background-color: #86c232;
    color: #fff;
    cursor: pointer;
    font-size: 12px;
}

.divButtons button:hover{
    background-color: #61892f;
    color: white;
}

{% endblock %}

{% block content %}
<div style="background-color: #474b4f;">
<section>
<nav></nav>
<div style="background-color: #000;">
  <h1 align="center">{{ preview.0.movie.name }}</h1>
  <div class="container" style="background-color: #474b4f;">
    <div class="description">
      <div class="icons">
        <svg width="3em" height="3em" viewBox="0 0 16 16" class="bi bi-calendar-check" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
        <path fill-rule="evenodd" d="M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1zm1-3a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2z"/>
        <path fill-rule="evenodd" d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z"/>
        </svg>

        <p>DATA PREMIERY:<br/>{{ preview.0.premiere|date:"Y-m-d" }}</p>

        <svg style=" margin-left: auto;" width="3em" height="3em" viewBox="0 0 16 16" class="bi bi-clock" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm8-7A8 8 0 1 1 0 8a8 8 0 0 1 16 0z"/>
        <path fill-rule="evenodd" d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
        </svg>
        <p>CZAS TRWANIA:<br/>{{ preview.0.movie.lenght }}</p>

      </div>
      <p>{{ preview.0.movie.description }}</p>
      <table class="infoTable">
        <tr>

          <th><p>GATUNEK FILMU:</p></th>
          <th><p>{{ preview.0.movie.genre }}</p></th>

        </tr>



      </table>


    </div>
    <div class="imageDiv">
    	{% load static %}
      	<img src="{% static  preview.0.movie.image.url %}">
    </div>
  </div>
</div>
<nav></nav>
</section>

<div id="myDIV" style="background-color: #6b6e70;">
    <button class="btn active" id="b1" onclick="setDateVal(1)">Dziś</button>
    <button class="btn" id="b2" onclick="setDateVal(2)">Pon</button>
    <button class="btn" id="b3" onclick="setDateVal(3)">Wtr</button>
    <button class="btn" id="b4" onclick="setDateVal(4)">Sr</button>
    <button class="btn" id="b5" onclick="setDateVal(5)">Czw</button>
    <button class="btn" id="b6" onclick="setDateVal(6)">Pt</button>
    <button class="btn" id="b7" onclick="setDateVal(7)">Sob</button>
    <button class="btn" id="b8" >
      <input id="datepicker"/>
    </button>
</div>


<section>
<nav></nav>
{% for show, showHall in object_list %}
    {% if showHall %}
    <div class="container2">

    <div class="divInfo"><div class="divHeader"><h3>{{ preview.0.cinema.name }}</h3>
    <p>
      <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-geo-alt" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
</svg>
        {{ preview.0.cinema.city }} - {{ preview.0.cinema.adress }} </p></div><div class = "spacer"></div>
    <div class="divButtons"><p>
          {% for instance in showHall %}  {% ifchanged instance.pricing.priceName %} </p><p>{{ instance.pricing.priceType }}<br/> {% endifchanged %} <button onclick="goToShow({{ instance.id }})">{{ instance.dateTime|date:"H:i"  }}</button>{% endfor %}</p>
      </div></div>

  </div>
    {% endif %}
  {% endfor %}
<nav></nav>
</section>
</div>
{% endblock %}

{% block script %}
var WeekDays = ["Pn","Wt","Śr","Cz","Pt","So","Nd"];
var date = new Date();
var date2 = new Date();
var dd="";
document.getElementById("b2").innerHTML = WeekDays[date2.getDay()];
document.getElementById("b3").innerHTML = WeekDays[(date2.getDay()+1)%7];
document.getElementById("b4").innerHTML = WeekDays[(date2.getDay()+2)%7];
document.getElementById("b5").innerHTML = WeekDays[(date2.getDay()+3)%7];
document.getElementById("b6").innerHTML = WeekDays[(date2.getDay()+4)%7];
document.getElementById("b7").innerHTML = WeekDays[(date2.getDay()+5)%7];

{% if request.GET.id %}
var current = document.getElementsByClassName("active");
current[0].className = current[0].className.replace(" active", "");

var current2 = document.getElementsByClassName("btn");
current2[{{ request.GET.id|add:-1 }}].className += " active";
{% endif %}

{% if request.GET.date %}
dd = "{{ request.GET.date }}"
{% endif %}


var header = document.getElementById("myDIV");
var btns = header.getElementsByClassName("btn");
for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener("click", function() {
  var current = document.getElementsByClassName("active");
  current[0].className = current[0].className.replace(" active", "");
  this.className += " active";
  });
}



function setDateVal(x){
  var date2 = new Date();
  var result;
  var result2;
  var id;
  if(x==1){
    result = date2;
  }
  else if(x==2){
    date2.setDate(date2.getDate()+1);
    result = date2
  }
  else if(x==3){
    date2.setDate(date2.getDate()+2);
    result = date2;
  }
  else if(x==4){
    date2.setDate(date2.getDate()+3);
    result = date2;
  }
  else if(x==5){
    date2.setDate(date2.getDate()+4);
    result = date2;
  }
  else if(x==6){
    date2.setDate(date2.getDate()+5);
    result = date2;
  }
  else if(x==7){
    date2.setDate(date2.getDate()+6);
    result = date2;
  }
  else if(x==8){
    result2 = $('#datepicker').datepicker().value();
	if(result2=="")
	{	
		return;
	}
	else if (result2==dd)
	{
		return;
	}
  }

    text1 = window.location.href
    if(x==8){
        if(text1.indexOf("?") == -1){
            window.location.href += "?date=" + result2 + '&id=' + x;
        }
        else {
            window.location.href = text1.substring(0,text1.indexOf("?"))+ "?date=" + result2 + '&id=' + x;
        }
    }
    else {
        if(text1.indexOf("?") == -1){
            window.location.href += "?date=" + result.toISOString().slice(0,10) + '&id=' + x;
        }
        else {
            window.location.href = text1.substring(0,text1.indexOf("?"))+ "?date=" + result.toISOString().slice(0,10) + '&id=' + x;
        }
    }
}

$( "#datepicker" ).datepicker({
    format: 'yyyy-mm-dd' ,
    {% if request.GET.id == '8' %}
        value: '{{ request.GET.date }}',
    {% endif %}
    minDate: function() {
            var date = new Date();
            date.setDate(date.getDate());
            return new Date(date.getFullYear(), date.getMonth(), date.getDate());
        },
    maxDate: function() {
            var date = new Date();
            date.setDate(date.getDate()+21);
            return new Date(date.getFullYear(), date.getMonth(), date.getDate());
        },

         close: function (e, type) {
             setDateVal(8);
         }
});



function myListFilter() {
    var input, filter, ul, li, a, i, txtValue;
    input = document.getElementById("myInput");
    filter = input.value.toUpperCase();
    ul = document.getElementById("myUL");
    li = ul.getElementsByTagName("li");
    for (i = 0; i < li.length; i++) {
        a = li[i].getElementsByTagName("h3")[0];
        txtValue = a.textContent || a.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
            li[i].style.display = "";
        } else {
            li[i].style.display = "none";
        }
    }
}

function goToShow(x) {
    window.location.href = "/seans/" + x;
}

function goToPreviews(){
    window.location.href = "/zapowiedzi/{{ preview.0.cinema.id }}";
}
{% endblock %}
